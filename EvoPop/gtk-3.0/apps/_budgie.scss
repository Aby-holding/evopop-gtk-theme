/*********
* Budgie *
**********/

$budgie_panel_bg_color: $headerbar_bg_color;
$budgie_panel_fg_color: $headerbar_fg_color;

$pos_list: ((top, bottom),(bottom,top),(left,right),(right,left));

@function gtkalpha($c,$a) {
  @return unquote("alpha(#{$c},#{$a})");
}

%app_indicators {

  &:hover {
    background-color: transparentize(black, 0.9);
  }

  &:active,
  &:checked {
    // background-color: transparentize(black, 0.8);
  }

  @each $pos, $alt_pos in $pos_list {
    .#{$pos} & {

      @at-root {
        .#{$pos} .budgie-panel .unpinned .launcher,
        .#{$pos} .budgie-panel .pinned .launcher.running {
          border-#{$pos}: 2px solid transparentize($budgie_panel_fg_color, 0.8);
        }
      }

      &:hover {
        border-#{$pos}: 3px solid transparentize($budgie_panel_fg_color, 0.5);
      }

      &:active,
      &:checked {
        border-#{$pos}: 3px solid $budgie_panel_fg_color;
      }
    }
  }
}

// Positional Styles
@each $pos, $alt_pos in $pos_list {

  // Panel borders
  .#{$pos} .budgie-panel {
    border-#{$alt_pos}: 1px solid transparentize(black,0.8);
    box-shadow:inset 0 1px 0 0 transparentize(white,0.9);
  }

  // Raven borders
  .#{$pos} .raven-frame {
    border-#{$alt_pos}: 1px solid transparentize(black, 0.2);
    box-shadow:inset 0 0 0 1px transparentize(white, 0.7);
  }

  // Shadows
  .#{$pos} .shadow-block {
    background-color: transparent;
    background-image: linear-gradient(to $alt_pos,
                      $shadow_color,
                      transparent,
                      transparent);
  }
}

// Budgie
.budgie-container {
  background-image: none;
  background-color: transparent;

  &:backdrop {
    background-image: none;
    background-color: transparent;
  }
}

// Budgie Menu
.budgie-menu {

  GtkSearchEntry.entry:not(:selected) {
    border: none;
    box-shadow: none;
    background: none;
    font-size: 100%;

    &.image { padding-left: 0px; padding-right: 6px; }
  }
  .list-row.activatable:selected,
  .list-row.activatable:selected .button { color: inherit; }
  .list .button, .button { border-color: transparent; }
}

// Panel
.budgie-panel {
  color: $budgie_panel_fg_color;
  background-color: $budgie_panel_bg_color;

  // this is the actual style for some reason
  &:backdrop {
    color: $budgie_panel_fg_color;
    background-color: $budgie_panel_bg_color;
  }

  // Menu
  BudgieMenuApplet {
    font: bold;
    .label {
      color: $budgie_panel_fg_color;
      icon-shadow: 0 1px $icon_shadow_color;
      text-shadow: 0 1px $text_shadow_color;
    }
  }

  // Clock
  ClockApplet {
    font: monospace bold;
    font-size: 90%;
    .label {
      color: $budgie_panel_fg_color;
      icon-shadow: 0 1px $icon_shadow_color;
      text-shadow: 0 1px $text_shadow_color;
    }
  }

  // Tasklist
  WnckTasklist {
    .button,
    .button:backdrop {

      border-radius: 0;

      @if $variant == 'default' {
        &:not(:hover):not(:active):not(:checked) { color: gtkalpha(currentColor, 0.5); }
        background: none;
        background-clip: padding-box;
        border: none;

        @extend %app_indicators;
      }
    }
  }

  // Icon Tasklist
  .launcher {
    transition: all 100ms cubic-bezier(0.25, 0.46, 0.45, 0.94);
    padding-left: 2px;
    padding-right: 2px;
    border-color: transparentize($budgie_panel_bg_color, 1.0); // fixes the transition

    &:hover { -gtk-image-effect: highlight; }
  }

  .pinned,
  .unpinned {
    .launcher,
    .launcher.running {
      @extend %app_indicators;
      padding: 2px 6px;
    }
  }
}

// Panel borders
.bottom .budgie-panel {
  border: none;
  box-shadow:none;
  background:none;
}

// Raven

.raven {
  color: $fg_color;
  background-color: transparentize($bg_color, 0.1);
  transition: 170ms ease-out;

  .raven-header {
    padding: 4px;
    font: bold;
    text-shadow: 0 1px $text_shadow_color;
    icon-shadow: 0 1px $icon_shadow_color;
    background-color: transparentize($bg_color, 0.7);
    color: $fg_color;
    border: solid $borders_color;
    border-width: 1px 0 1px 0;
    box-shadow:inset 0 1px 0 0 transparentize(white,0.9),
              inset 0 -1px 0 0 transparentize(black,0.9);

    &.top { border-top-style: none; }
    &.bottom { border-bottom-style: none; }

    & .button.image-button {
      background-color: transparent;
      box-shadow: none;
      &:hover {
        color: $selected_bg_color;
      }
      &:active,&:checked {
        color: darken($selected_bg_color,5%);
      }
    }

    GtkSwitch {
      -GtkSwitch-slider-width: 16px;
      -GtkSwitch-slider-height: 16px;
      border-radius: 12px;

      .slider {
        border-radius: 8px;
      }
    }
  }

  @if $variant=='default' {
    .expander-button { color: gtkalpha(currentColor, 0.5); }
  }

  .raven-background {
    background-color: transparentize($bg_color, 0.5);
    border-bottom: 0px solid $borders_color;
    box-shadow: inset 0 -1px 0 0 transparentize(black,0.7);;

    &.middle { border-bottom-style: none; }  // applet background between two headers

  }

  // Calendar
  .raven-calendar {
    background-color: transparentize($bg_color, 0.5);
    border:none;
    padding: 2px;
    border-bottom:1px solid $borders_color;
    .button { box-shadow: none; }
  }

  // Session Buttons
  .powerstrip {
    background-color: transparent;
    background-image:none;
    border: none;
    box-shadow:none;
  }

  .powerstrip .button.image-button {
    border-radius:50%;
    padding: 12px;
    color: $selected_fg_color;
    background: $darkpurple;
    border: none;
    box-shadow: inset 0px -1px 0px 0px rgba(0,0,0,0.2),inset 0px 1px 0px 0px rgba(255,255,255,0.2), 1px 1px transparentize(black,0.8);
    font-size: 100%;

    &:hover {
      transition: 170ms ease all;
      background: lighten($darkpurple, 5%);
      color: $selected_fg_color;
    }

    &:active {
      transition: 170ms ease all;
      background: lighten($darkpurple, 10%);
      color: $selected_fg_color;
    }

    &:first-child {
      background: darken($blue,5%);
      &:hover {
        transition: 170ms ease all;
        background: $blue;
      }

      &:active {
        transition: 170ms ease all;
        background: lighten($blue, 5%);
      }
    }

    &:last-child {
      background: $red;
      &:hover {
        transition: 170ms ease all;
        background: lighten($red, 5%);
      }

      &:active {
        transition: 170ms ease all;
        background: lighten($red, 10%);
      }
    }
  }

  .option-subtitle {
    font-size: smaller;
  }
}

// MPRIS Applet
.raven-mpris {
  text-shadow: 0 1px $text-shadow_color;
  icon-shadow: 0 1px $icon_shadow_color;
  color: $budgie_panel_fg_color;
  background-color: transparentize($budgie_panel_bg_color, 0.2);
  border: solid transparentize(black, 0.8);
  border-width: 1px 0;
  box-shadow:inset 0 1px 0 0 transparentize(white,0.9),
            inset 0 -1px 0 0 transparentize(white,0.95),
            0 1px 1px 0 transparentize(black,0.9);

  .button.image-button { padding: 8px; }
}

// Notifications
.budgie-notification-window {
  border-radius: 4px;
  border:none;
  border-top: 1px solid transparentize(white,0.9);
  background-color: transparentize($bg_color,0.1);
  box-shadow: 0 2px 2px 0 $shadow_color, 0 0 0 1px $shadow_color;
}

.budgie-notification {

  &.background {
    border-radius: 4px;
    padding: 4px;
  }

  .notification-title {
    font-size: 110%;
    color: $fg_color;
  }

  .notification-body {
    border:none;
    color: transparentize($fg_color, 0.3);
  }
}

// Session Dialog
.budgie-session-dialog {
  border-radius: 4px;
  border:none;
  background-color: if($variant=='light',$backdrop_base_color,$backdrop_bg_color);
  border-top: 1px solid transparentize(white,0.9);

  &.background {
    padding:12px;
    box-shadow: 0 1px 1px 0 $shadow_color, 0 0 0 1px $shadow_color;
  }

  .button {
    background-image:none;
    background-color: if($variant=='light',$backdrop_base_color,$backdrop_bg_color);
    border-left-style: solid;
    border-right-style: none;
    border-bottom-style: none;
    border-top: 1px solid darken(if($variant=='light',$backdrop_base_color,$backdrop_bg_color), 20%);

    &:hover {
      background-color: $selected_bg_color;
    }

    &:active,&:selected {
      border-radius: 0;
      background-color: darken($selected_bg_color,5%);
    }

    &.destructive-action {
      background-color: $destructive_color;
    }
  }

  .linked.horizontal > .button {
    border-bottom: none;
    border-radius: 0;
    &:first-child { border-left: none; border-radius: 0 0 0 4px; }
    &:last-child {
      border-right: none; border-radius: 0 0 4px 0;
    }
  }
}

// PolKit Dialog
.budgie-polkit-dialog {
  @extend .budgie-session-dialog;

  .message { color: transparentize($budgie_panel_fg_color, 0.3); }
  .failure { color: $red; }
}
